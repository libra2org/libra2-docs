---
title: "Rotaci贸n de Claves de Cuenta"
---

import { Aside, Steps } from '@astrojs/starlight/components';

<Aside type="caution">
  La rotaci贸n de claves de cuenta es una caracter铆stica avanzada que debe usarse con precauci贸n.
  La mayor铆a de usuarios nunca necesitar谩n usar esta caracter铆stica.
</Aside>

Las cuentas de Aptos Move tienen una direcci贸n p煤blica, una clave de autenticaci贸n, una clave p煤blica,
y una clave privada. La direcci贸n p煤blica es permanente, siempre coincidiendo con
la clave de autenticaci贸n inicial de la cuenta, que se deriva de la clave privada
original.

El modelo de cuenta de Aptos facilita la capacidad 煤nica de rotar la clave privada
de una cuenta. Dado que la direcci贸n de una cuenta es la clave de autenticaci贸n _inicial_,
la capacidad de firmar para una cuenta puede ser transferida a otra clave privada sin
cambiar su direcci贸n p煤blica.

En esta gu铆a, mostramos ejemplos de c贸mo rotar la clave de autenticaci贸n de una cuenta
usando la CLI y algunos de los diversos SDKs de Aptos.

Aqu铆 est谩n los enlaces de instalaci贸n para los SDKs que cubriremos en este ejemplo:

- [CLI de Aptos](/build/cli)
- [SDK de TypeScript](/build/sdks/ts-sdk)
- [SDK de Python](/build/sdks/python-sdk)

<Aside type="caution">
  Algunos de los siguientes ejemplos usan claves privadas. No compartas tus claves
  privadas con nadie.
</Aside>

## Rotaciones de claves probadas y no probadas

La l贸gica en la cadena para la rotaci贸n de claves se implementa a trav茅s de dos APIs de Move:

1. [`account::rotate_authentication_key`], que ejecuta una rotaci贸n "probada".
2. [`account::rotate_authentication_key_call`], que ejecuta una rotaci贸n "no probada".

### Rotaciones de claves probadas

La API [`account::rotate_authentication_key`] requiere un
\[`account::RotationProofChallenge`] firmado, que prueba que la operaci贸n de rotaci贸n es
aprobada por la clave privada tanto antes _como_ despu茅s de la operaci贸n. Cuando la
operaci贸n es exitosa, la tabla \[`account::OriginatingAddress`] se actualiza
con una entrada que mapea desde la nueva clave de autenticaci贸n a la direcci贸n
de cuenta correspondiente.

La tabla \[`account::OriginatingAddress`] es una tabla de b煤squeda inversa que permite
a los usuarios consultar una direcci贸n de cuenta asociada con una clave de autenticaci贸n dada,
y solo permite una entrada por clave de autenticaci贸n. De ah铆 el requisito de un
\[`account::RotationProofChallenge`] firmado para asegurar que un actor malicioso no
rote la clave de autenticaci贸n de una cuenta a una clave que ya est谩 en la
tabla, ya que este ataque impedir铆a la b煤squeda de la direcci贸n de origen v谩lida que
el titular de una clave de autenticaci贸n hab铆a aprobado previamente.

Notablemente, la tabla \[`account::OriginatingAddress`] se actualiza _solo_ durante la rotaci贸n
de claves, no durante la generaci贸n est谩ndar de cuentas. Esto significa que con rotaciones
de claves probadas, una clave privada dada puede te贸ricamente autenticar hasta dos cuentas
al mismo tiempo:

1. La direcci贸n de cuenta derivada de la clave privada durante la generaci贸n est谩ndar
   de cuentas, asumiendo que la cuenta no ha sufrido ninguna rotaci贸n de claves.
2. Una segunda direcci贸n arbitraria, que ha tenido su clave de autenticaci贸n rotada a
   la clave privada dada.

Sin embargo, se considera una mejor pr谩ctica autenticar solo _una_ cuenta con
una clave privada dada a la vez, porque siempre que la tabla
\[`account::OriginatingAddress`] se actualiza, la l贸gica subyacente primero
verifica si la clave de autenticaci贸n inicial de la cuenta que rota est谩 en la tabla,
y si es as铆, verifica que la direcci贸n de la cuenta que rota es la mapeada en la
tabla.

Esto significa que si la clave de autenticaci贸n de una cuenta arbitraria se rota a
una clave privada dada, la cuenta est谩ndar cuya direcci贸n se deriva originalmente
de la clave privada no podr谩 ejecutar su primera rotaci贸n de clave de autenticaci贸n
mientras la clave de autenticaci贸n asociada est茅 mapeada a una segunda direcci贸n
de cuenta arbitraria en la tabla \[`account::OriginatingAddress`], porque esta
operaci贸n fallar铆a la verificaci贸n de que la direcci贸n de la cuenta que rota es la
mapeada en la tabla (ya que la tabla solo se actualiza durante la rotaci贸n, no
durante la generaci贸n est谩ndar de cuentas).

Para prevenir este problema y asegurar que se sigan las mejores pr谩cticas, siempre puedes ejecutar
\[`account::set_originating_address`] despu茅s de generar una nueva cuenta (ver tutorial
de CLI a continuaci贸n).

### Rotaciones de claves no probadas

A diferencia de [`account::rotate_authentication_key`], la
[`account::rotate_authentication_key_call`] _no_ requiere un
\[`account::RotationProofChallenge`] firmado. Esto significa que la operaci贸n no est谩 probada
en el sentido de que la clave privada de _despu茅s_ de la operaci贸n ha aprobado la
rotaci贸n de claves. Por lo tanto, la tabla \[`account::OriginatingAddress`] _no_ se actualiza
para rotaciones de claves no probadas, y por lo tanto no hay restricci贸n en el n煤mero de
cuentas que pueden ser autenticadas con una clave privada dada. Nota que la
CLI `aptos` actualmente no soporta rotaciones de claves no probadas.

<Aside type="note" emoji="">
  La [`account::rotate_authentication_key_call`] fue introducida para soportar
  algoritmos de clave no est谩ndar, como passkeys, que no pueden producir pruebas de
  conocimiento durante las operaciones de rotaci贸n.
</Aside>

Mientras que es t茅cnicamente posible autenticar tantas cuentas como quieras
con una clave de autenticaci贸n dada a trav茅s de rotaciones de claves no probadas,
no se considera una mejor pr谩ctica porque este enfoque no garantiza una asignaci贸n uno a uno.

Si ejecutas una rotaci贸n de clave no probada, se sugiere que sigas con
\[`account::set_originating_address`] para asegurar una asignaci贸n uno a uno de
clave de autenticaci贸n a direcci贸n de cuenta para facilitar la b煤squeda de la direcci贸n de origen
(ver tutorial de CLI a continuaci贸n).

## Rotaci贸n de claves con la CLI de Aptos

<Steps>
  1. Inicia una localnet

     Inicia una localnet:

     ```shellscript filename="Terminal"
     aptos node run-localnet
     ```

     La localnet est谩 lista cuando imprime:

     ```shellscript filename="Terminal"
     Applying post startup steps...

     Setup is complete, you can now use the localnet!
     ```

     <Aside type="note" emoji="">
       Si est谩s en un sistema UNIX-like, el siguiente comando puede usarse para iniciar una
       localnet limpia como un proceso en segundo plano:

       ```shellscript filename="Terminal"
       mkdir -p localnet-data
       aptos node run-localnet \
           --assume-yes \
           --test-dir localnet-data \
           --force-restart &
       export LOCALNET_PID=$!
       ```

       Puedes detener la localnet en cualquier momento con el siguiente comando:

       ```shellscript filename="Terminal"
       kill $LOCALNET_PID
       ```
     </Aside>

  2. Genera una clave privada

     Crea una clave privada correspondiente a una clave de autenticaci贸n, y por lo tanto
     direcci贸n de cuenta inicial, que comienza con el prefijo de fantas铆a `0xaaa`:

     ```shellscript filename="Terminal"
     aptos key generate \
         --assume-yes \
         --output-file private-key-a \
         --vanity-prefix 0xaaa
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": {
           "Account Address:": "0xaaa5131b4d3fcef8d33ee465c4ee65727e36039f283455be87b1164200572e5b",
           "PublicKey Path": "private-key-a.pub",
           "PrivateKey Path": "private-key-a"
         }
       }
       ```
     </details>

     Esto generar谩 dos archivos:

     1. Una clave privada en `private-key-a`.
     2. Una clave p煤blica en `private-key-a.pub`.

     Ya que no hay una cuenta asociada con la clave de autenticaci贸n, el
     siguiente comando deber铆a fallar con un mensaje correspondiente:

     ```shellscript filename="Terminal"
     aptos account lookup-address \
         --public-key-file private-key-a.pub \
         --url http://localhost:8080
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Error": "API error: API error Error(AccountNotFound): Account not found by Address(0xaaafb224eb00e4d0ef520ce02038ede850893622562a4189b7f6e5d94454ccd9) and Ledger version(1206)"
       }
       ```
     </details>

  3. Inicializa un perfil

     Usa la clave privada para inicializar `test-profile-1` en la localnet:

     ```shellscript filename="Terminal"
     aptos init \
         --assume-yes \
         --network local \
         --private-key-file private-key-a \
         --profile test-profile-1
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       Configuring for profile test-profile-1
       Configuring for network Local
       Using command line argument for private key
       Account 0xaaa5131b4d3fcef8d33ee465c4ee65727e36039f283455be87b1164200572e5b doesn\'t exist, creating it and funding it with 100000000 Octas
       Account 0xaaa5131b4d3fcef8d33ee465c4ee65727e36039f283455be87b1164200572e5b funded successfully

       ---
       Aptos CLI is now set up for account 0xaaa5131b4d3fcef8d33ee465c4ee65727e36039f283455be87b1164200572e5b as profile test-profile-1!  Run `aptos --help` for more information about commands
       {
         "Result": "Success"
       }
       ```
     </details>

     Nota que siempre puedes ver el perfil con:

     ```shellscript filename="Terminal"
     aptos config show-profiles --profile test-profile-1
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": {
           "test-profile-1": {
             "has_private_key": true,
             "public_key": "0xe0bfe46f41c5be40e7a068e8dff4d6016126b226d947a39262f5b2347217a7e3",
             "account": "aaa5131b4d3fcef8d33ee465c4ee65727e36039f283455be87b1164200572e5b",
             "rest_url": "http://localhost:8080",
             "faucet_url": "http://localhost:8081"
           }
         }
       }
       ```
     </details>

     Sin embargo, esto no mostrar谩 la clave privada, que est谩 oculta por defecto. Si quieres
     ver la clave privada:

     ```shellscript filename="Terminal"
     aptos config show-private-key --profile test-profile-1
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": "0xcc3b0c38ad99e171263a7af930464313d1fb105d0d8e6a4b13f9b1140563a7dd"
       }
       ```
     </details>

  4. Busca la direcci贸n

     Ahora que hay una cuenta en la cadena de Aptos asociada con la clave de autenticaci贸n,
     puedes buscar la direcci贸n de la cuenta usando `aptos account lookup-address`:

     ```shellscript filename="Terminal"
     aptos account lookup-address \
         --public-key-file private-key-a.pub \
         --url http://localhost:8080
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": "aaa5131b4d3fcef8d33ee465c4ee65727e36039f283455be87b1164200572e5b"
       }
       ```
     </details>

     Almacena esta direcci贸n en una variable de shell:

     ```shellscript filename="Terminal"
     ADDRESS_A=aaa...
     ```

     <Aside type="note" emoji="">
       Si est谩s usando una m谩quina UNIX-like que tiene `jq`, puedes almacenar f谩cilmente la direcci贸n de la cuenta via:

       ```shellscript filename="Terminal"
       export ADDRESS_A=$(
           aptos account lookup-address \
               --public-key-file private-key-a.pub \
               --url http://localhost:8080 \
                   | jq -r '.Result'
       )
       echo $ADDRESS_A
       ```
     </Aside>

  5. Busca la clave de autenticaci贸n

     Recuerda que la direcci贸n de una cuenta es id茅ntica a su clave de autenticaci贸n
     cuando se crea por primera vez, lo que significa que la direcci贸n de cuenta `aaa...` es
     id茅ntica a la clave de autenticaci贸n de la cuenta:

     ```shellscript filename="Terminal"
     aptos move view \
         --args address:$ADDRESS_A \
         --function-id 0x1::account::get_authentication_key \
         --url http://localhost:8080
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": [
           "0xaaa5131b4d3fcef8d33ee465c4ee65727e36039f283455be87b1164200572e5b"
         ]
       }
       ```
     </details>

     Por lo tanto, almacena la clave de autenticaci贸n en una variable de shell:

     ```shellscript
     AUTH_KEY_A=$ADDRESS_A
     ```

     Nota, sin embargo, ya que la cuenta no ha tenido su clave de autenticaci贸n rotada,
     no hay una entrada correspondiente en la tabla \[`account::OriginatingAddress`]:

     ```shellscript filename="Terminal"
     aptos move view \
         --args address:$AUTH_KEY_A \
         --function-id 0x1::account::originating_address \
         --url http://localhost:8080
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": [
           {
             "vec": []
           }
         ]
       }
       ```
     </details>

  6. Establece la direcci贸n de origen

     Para asegurar una entrada en la tabla \[`account::OriginatingAddress`] para esta nueva cuenta,
     puedes ejecutar \[`account::set_originating_address`]:

     ```shellscript filename="Terminal"
     aptos move run \
         --assume-yes \
         --function-id 0x1::account::set_originating_address \
         --profile test-profile-1
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": {
           "transaction_hash": "0x216992ef37a3c2f42aa9f8fed8f94d9f945a00e952dfe96b46123bb5c387ab6c",
           "gas_used": 444,
           "gas_unit_price": 100,
           "sender": "aaa5131b4d3fcef8d33ee465c4ee65727e36039f283455be87b1164200572e5b",
           "sequence_number": 0,
           "success": true,
           "timestamp_us": 1717809169531279,
           "version": 3268,
           "vm_status": "Executed successfully"
         }
       }
       ```
     </details>

     Luego deber铆as ver una entrada en la tabla \[`account::OriginatingAddress`]:

     ```shellscript filename="Terminal"
     aptos move view \
         --args address:$AUTH_KEY_A \
         --function-id 0x1::account::originating_address \
         --url http://localhost:8080
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": [
           {
             "vec": [
               "0xaaa5131b4d3fcef8d33ee465c4ee65727e36039f283455be87b1164200572e5b"
             ]
           }
         ]
       }
       ```
     </details>

  7. Rota la clave de autenticaci贸n

     Genera una nueva clave privada:

     ```shellscript filename="Terminal"
     aptos key generate \
         --assume-yes \
         --output-file private-key-b \
         --vanity-prefix 0xbbb
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": {
           "PrivateKey Path": "private-key-b",
           "Account Address:": "0xbbbdb12f4fa23b8fe8711b77f4ab7108f3a22077c5dfe787eed3d048a0b82734",
           "PublicKey Path": "private-key-b.pub"
         }
       }
       ```
     </details>

     Rota la clave de autenticaci贸n de la cuenta en la cadena existente a la nueva
     clave privada:

     ```shellscript filename="Terminal"
     aptos account rotate-key \
         --assume-yes \
         --new-private-key-file private-key-b \
         --profile test-profile-1 \
         --save-to-profile test-profile-2
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": {
           "message": "Saved new profile test-profile-2",
           "transaction": {
             "transaction_hash": "0xe561b710390511203511d15eee6f019a2e43ba32f8e3b7ce6bf812232e3bd27f",
             "gas_used": 449,
             "gas_unit_price": 100,
             "sender": "aaa8dc0f5e7a6e820f7b1906d99864412b12274ed259ad06bc2c2d8ee7b51e51",
             "sequence_number": 1,
             "success": true,
             "timestamp_us": 1717810059696079,
             "version": 1109,
             "vm_status": "Executed successfully"
           }
         }
       }
       ```
     </details>

  8. Compara perfiles

     Compara `test-profile-1` (que ahora est谩 obsoleto) con `test-profile-2` (que es
     actual) notando que la clave p煤blica ha cambiado, pero no la direcci贸n de la cuenta:

     ```shellscript filename="Terminal"
     aptos config show-profiles --profile test-profile-1
     aptos config show-profiles --profile test-profile-2
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": {
           "test-profile-1": {
             "has_private_key": true,
             "public_key": "0xb517173e68f4116e99c7fa1677058a6ee786a3b9e12447000db7fd85ab99dbdd",
             "account": "aaa8dc0f5e7a6e820f7b1906d99864412b12274ed259ad06bc2c2d8ee7b51e51",
             "rest_url": "http://localhost:8080",
             "faucet_url": "http://localhost:8081"
           }
         }
       }
       {
         "Result": {
           "test-profile-2": {
             "has_private_key": true,
             "public_key": "0xadc3dd795fdd8569f59dc7b9900b38a5d7b95348b815de4eb5f00e2c2da07916",
             "account": "aaa8dc0f5e7a6e820f7b1906d99864412b12274ed259ad06bc2c2d8ee7b51e51",
             "rest_url": "http://localhost:8080",
             "faucet_url": "http://localhost:8081"
           }
         }
       }
       ```
     </details>

     Busca la nueva clave de autenticaci贸n:

     ```shellscript filename="Terminal"
     aptos move view \
         --args address:$ADDRESS_A \
         --function-id 0x1::account::get_authentication_key \
         --url http://localhost:8080
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": [
           "0xbbbdb12f4fa23b8fe8711b77f4ab7108f3a22077c5dfe787eed3d048a0b82734"
         ]
       }
       ```
     </details>

     Almacena la clave de autenticaci贸n en una variable de shell:

     ```shellscript filename="Terminal"
     AUTH_KEY_B=bbb...
     ```

     <Aside type="note" emoji="">
       Si est谩s usando una m谩quina UNIX-like que tiene `jq`, puedes almacenar f谩cilmente la clave de autenticaci贸n via:

       ```shellscript filename="Terminal"
       export AUTH_KEY_B=$(
           aptos move view \
               --args address:$ADDRESS_A \
               --function-id 0x1::account::get_authentication_key \
               --url http://localhost:8080 \
               | jq -r '.Result[0]'
       )
       echo $AUTH_KEY_B
       ```
     </Aside>

  9. Busca las direcciones de origen

     Verifica la direcci贸n de origen para la nueva clave de autenticaci贸n:

     ```shellscript filename="Terminal"
     aptos move view \
         --args address:$AUTH_KEY_B \
         --function-id 0x1::account::originating_address \
         --url http://localhost:8080
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": [
           {
             "vec": [
               "0xaaa8dc0f5e7a6e820f7b1906d99864412b12274ed259ad06bc2c2d8ee7b51e51"
             ]
           }
         ]
       }
       ```
     </details>

     Verifica la direcci贸n de origen para la clave de autenticaci贸n antigua:

     ```shellscript filename="Terminal"
     aptos move view \
         --args address:$AUTH_KEY_A \
         --function-id 0x1::account::originating_address \
         --url http://localhost:8080
     ```

     <details>
       <summary>Ejemplo de salida</summary>

       ```shellscript filename="Terminal"
       {
         "Result": [
           {
             "vec": []
           }
         ]
       }
       ```
     </details>

  10. Intenta una rotaci贸n inv谩lida (misma clave)

      Intenta una rotaci贸n inv谩lida donde la clave de autenticaci贸n actual es id茅ntica
      a la nueva clave de autenticaci贸n:

      ```shellscript filename="Terminal"
      aptos account rotate-key \
          --assume-yes \
          --new-private-key-file private-key-b \
          --profile test-profile-2 \
          --skip-saving-profile
      ```

      <details>
        <summary>Ejemplo de salida</summary>

        ```shellscript filename="Terminal"
        {
          "Error": "Invalid arguments: New public key cannot be the same as the current public key"
        }
        ```
      </details>

  11. Intenta una rotaci贸n inv谩lida (nueva clave ya mapeada)

      Crea otra clave privada:

      ```shellscript filename="Terminal"
      aptos key generate \
          --assume-yes \
          --output-file private-key-c \
          --vanity-prefix 0xccc
      ```

      <details>
        <summary>Ejemplo de salida</summary>

        ```shellscript filename="Terminal"
        {
          "Result": {
            "PrivateKey Path": "private-key-c",
            "PublicKey Path": "private-key-c.pub",
            "Account Address:": "0xccc79d46b2963cb87f2ff32c51eb6c6361e8aa108d334d3183c3016389542958"
          }
        }
        ```
      </details>

      Inicializa un nuevo perfil:

      ```shellscript filename="Terminal"
      aptos init \
          --assume-yes \
          --network local \
          --private-key-file private-key-c \
          --profile test-profile-3
      ```

      <details>
        <summary>Ejemplo de salida</summary>

        ```shellscript filename="Terminal"
        Configuring for profile test-profile-3
        Configuring for network Local
        Using command line argument for private key
        Account 0xccc79d46b2963cb87f2ff32c51eb6c6361e8aa108d334d3183c3016389542958 doesn\'t exist, creating it and funding it with 100000000 Octas
        Account 0xccc79d46b2963cb87f2ff32c51eb6c6361e8aa108d334d3183c3016389542958 funded successfully

        ---
        Aptos CLI is now set up for account 0xccc79d46b2963cb87f2ff32c51eb6c6361e8aa108d334d3183c3016389542958 as profile test-profile-3!  Run `aptos --help` for more information about commands
        {
          "Result": "Success"
        }
        ```
      </details>

      Intenta una rotaci贸n inv谩lida donde la nueva clave de autenticaci贸n ya est谩 mapeada:

      ```shellscript filename="Terminal"
      aptos account rotate-key \
          --assume-yes \
          --max-gas 100000 \
          --new-private-key-file private-key-b \
          --profile test-profile-3 \
          --skip-saving-profile
      ```

      (`--max-gas` se especifica aqu铆 para omitir la simulaci贸n local, que no imprime
      como descriptivo de un error como la transacci贸n real.)

      <details>
        <summary>Ejemplo de salida</summary>

        ```shellscript filename="Terminal"
        {
          "Error": "API error: Unknown error Transaction committed on chain, but failed execution: Move abort in 0x1::account: ENEW_AUTH_KEY_ALREADY_MAPPED(0x10015): The new authentication key already has an entry in the `OriginatingAddress` table"
        }
        ```
      </details>

  12. Intenta una rotaci贸n inv谩lida (direcci贸n de origen inv谩lida)

      Rota la clave de autenticaci贸n para la cuenta `0xaaa...` para usar la clave de autenticaci贸n
      para la cuenta `0xccc...`:

      ```shellscript filename="Terminal"
      aptos account rotate-key \
          --assume-yes \
          --new-private-key-file private-key-c \
          --profile test-profile-2 \
          --save-to-profile test-profile-4
      ```

      <details>
        <summary>Ejemplo de salida</summary>

        ```shellscript filename="Terminal"
        {
          "Result": {
            "message": "Saved new profile test-profile-4",
            "transaction": {
              "transaction_hash": "0xa5dec792d82ef7471cdf82b9c957fc79b5815da770ad1dd9232ae4692e4f0895",
              "gas_used": 449,
              "gas_unit_price": 100,
              "sender": "aaa8dc0f5e7a6e820f7b1906d99864412b12274ed259ad06bc2c2d8ee7b51e51",
              "sequence_number": 2,
              "success": true,
              "timestamp_us": 1717812312772580,
              "version": 5355,
              "vm_status": "Executed successfully"
            }
          }
        }
        ```
      </details>

      Luego intenta rotar la clave de autenticaci贸n para la cuenta `0xccc...` por primera vez,
      una operaci贸n que est谩 bloqueada porque una entrada para la clave de autenticaci贸n
      se estableci贸 en la tabla \[`account::OriginatingAddress`] durante la 煤ltima operaci贸n:

      ```shellscript filename="Terminal"
      aptos account rotate-key \
          --assume-yes \
          --max-gas 100000 \
          --new-private-key-file private-key-b \
          --profile test-profile-3 \
          --skip-saving-profile
      ```

      (`--max-gas` se especifica aqu铆 para omitir la simulaci贸n local, que no imprime
      como descriptivo de un error como la transacci贸n real.)

      <details>
        <summary>Ejemplo de salida</summary>

        ```shellscript filename="Terminal"
        {
          "Error": "API error: Unknown error Transaction committed on chain, but failed execution: Move abort in 0x1::account: EINVALID_ORIGINATING_ADDRESS(0x6000d): Abort the transaction if the expected originating address is different from the originating address on-chain"
        }
        ```
      </details>

  13. Limpia

      Elimina los perfiles de prueba:

      ```shell filename="Terminal"
      aptos config delete-profile --profile test-profile-1
      aptos config delete-profile --profile test-profile-2
      aptos config delete-profile --profile test-profile-3
      aptos config delete-profile --profile test-profile-4
      ```

      Luego puedes detener la localnet y eliminar los archivos de clave y clave p煤blica.

      <Aside type="note" emoji="">
        Si est谩s usando una m谩quina UNIX-like:

        ```shell filename="Terminal"
        aptos config delete-profile --profile test-profile-1
        aptos config delete-profile --profile test-profile-2
        aptos config delete-profile --profile test-profile-3
        aptos config delete-profile --profile test-profile-4
        rm private-key-*
        kill $LOCALNET_PID
        rm -fr localnet-data
        ```
      </Aside>

  14. Rotaci贸n de claves para un Ledger

      Tambi茅n puedes realizar la rotaci贸n de clave de autenticaci贸n con una clave privada que
      est谩 seg煤nmente almacenada en una billetera de hardware Ledger. Para m谩s informaci贸n,
      ver la gu铆a de [Rotaci贸n de clave de autenticaci贸n para Ledger](/build/cli/trying-things-on-chain/ledger#authentication-key-rotation).
</Steps>

## Ejemplo de rotaci贸n de clave de TypeScript

Este programa crea dos cuentas en devnet, Alice y Bob, las funde, y luego
rota la clave de autenticaci贸n de Alice a la de Bob.

Ver el ejemplo completo para este c贸digo
[aqu铆](https://github.com/aptos-labs/aptos-ts-sdk/blob/main/examples/typescript/rotate_key.ts).

La funci贸n para rotar es muy simple:

{/* TODO CODE EXAMPLE */}

Comandos para ejecutar el script de ejemplo:

### Navega al directorio del SDK de TypeScript, instala las dependencias y ejecuta

rotate\_key.ts

```shellscript filename="Terminal"
cd ~/aptos-core/ecosystem/typescript/sdk/examples/typescript-esm
pnpm install && pnpm rotate_key
```

### rotate\_key.ts output

```shell filename="Terminal"
Account Address Auth Key Private Key Public Key
------------------------------------------------------------------------------------------------
Alice 0x213d...031013 '0x213d...031013' '0x00a4...b2887b' '0x859e...08d2a9'
Bob 0x1c06...ac3bb3 0x1c06...ac3bb3 0xf2be...9486aa 0xbbc1...abb808

...rotating...

Alice 0x213d...031013 '0x1c06...ac3bb3' '0xf2be...9486aa' '0xbbc1...abb808'
Bob 0x1c06...ac3bb3 0x1c06...ac3bb3 0xf2be...9486aa 0xbbc1...abb808
```

## Ejemplo de rotaci贸n de clave de Python

Este programa crea dos cuentas en devnet, Alice y Bob, las funde, y luego
rota la clave de autenticaci贸n de Alice a la de Bob.

Ver el ejemplo completo para este c贸digo
[aqu铆](https://github.com/aptos-labs/aptos-python-sdk/blob/main/examples/rotate_key.py).

Aqu铆 est谩 el c贸digo relevante que rota las claves de Alice a las de Bob:

{/* TODO CODE EXAMPLE */}

Comandos para ejecutar el script de ejemplo:

### Navega al directorio del SDK de Python, instala las dependencias y ejecuta

rotate\_key.ts

```shellscript filename="Terminal"
cd aptos-core/ecosystem/python/sdk
poetry install && poetry run python -m examples.rotate-key
```

### rotate\_key.py output

```shellscript filename="Terminal"
Account Address Auth Key Private Key Public Key
------------------------------------------------------------------------------------------------
Alice 0x213d...031013 '0x213d...031013' '0x00a4...b2887b' '0x859e...08d2a9'
Bob 0x1c06...ac3bb3 0x1c06...ac3bb3 0xf2be...9486aa 0xbbc1...abb808

...rotating...

Alice 0x213d...031013 '0x1c06...ac3bb3' '0xf2be...9486aa' '0xbbc1...abb808'
Bob 0x1c06...ac3bb3 0x1c06...ac3bb3 0xf2be...9486aa 0xbbc1...abb808
```

[`account::rotate_authentication_key`]: https://github.com/aptos-labs/aptos-core/blob/acb6c891cd42a63b3af96561a1aca164b800c7ee/aptos-move/framework/aptos-framework/sources/account.move#L326

[`account::rotate_authentication_key_call`]: https://github.com/aptos-labs/aptos-core/blob/acb6c891cd42a63b3af96561a1aca164b800c7ee/aptos-move/framework/aptos-framework/sources/account.move#L294

\[`account::RotationProofChallenge`
